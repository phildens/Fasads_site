{% load static %}


<div class="logos-section">
  <div class="logos-inner">
    <div class="logos-section-title">
      <p>Мы являемся официальными дилерами 22 заводов-производителей</p>
    </div>

    <div class="logos-grid" id="logos-slider">
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo1.png' %}" alt="Пятый элемент">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo2.png' %}" alt="ARHIO">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo3.png' %}" alt="Recke Brickerei">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo4.png' %}" alt="Laterem Antique">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo5.png' %}" alt="Skriaibin Ceramics">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo6.png' %}" alt="ЛСР">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo7.png' %}" alt="Царский Кирпич">
      </div>
      <div class="logo-card">
        <img draggable="false" src="{% static 'imgfolder/logo8.png' %}" alt="Ströher">
      </div>
    </div>
  </div>
</div>

      
    <script>
(function(){
  const slider = document.getElementById('logos-slider');
  if (!slider) return;

  // Drag/Swipe прокрутка
  let isDown = false, startX = 0, startLeft = 0;
  const onPointerDown = (e) => {
    if (window.matchMedia('(min-width: 901px)').matches) return;
    isDown = true;
    slider.classList.add('dragging');
    startX = (e.pageX !== undefined) ? e.pageX : (e.touches && e.touches[0].pageX);
    startLeft = slider.scrollLeft;
    pauseAutoplay();
  };
  const onPointerMove = (e) => {
    if (!isDown) return;
    const x = (e.pageX !== undefined) ? e.pageX : (e.touches && e.touches[0].pageX);
    slider.scrollLeft = startLeft + (startX - x);
  };
  const onPointerUp = () => {
    if (!isDown) return;
    isDown = false;
    slider.classList.remove('dragging');
    resumeAutoplaySoon();
  };

  slider.addEventListener('mousedown', onPointerDown);
  window.addEventListener('mousemove', onPointerMove);
  window.addEventListener('mouseup', onPointerUp);
  slider.addEventListener('touchstart', onPointerDown, {passive: true});
  slider.addEventListener('touchmove', onPointerMove, {passive: true});
  slider.addEventListener('touchend', onPointerUp);

  // Автопрокрутка
  const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  let autoTimer = null, resumeTimer = null;

  function cardStep(){
    const card = slider.querySelector('.logo-card');
    if (!card) return 0;
    const gap = parseFloat(getComputedStyle(slider).gap || '0');
    return card.offsetWidth + gap;
    // в режиме grid gap не мешает, но автоскролл работает только в mobile режиме
  }

  function tick(){
    if (window.matchMedia('(min-width: 901px)').matches) return;
    const step = cardStep();
    if (!step) return;
    const maxScroll = slider.scrollWidth - slider.clientWidth;
    const next = (slider.scrollLeft + step >= maxScroll - 2) ? 0 : (slider.scrollLeft + step);
    slider.scrollTo({ left: next, behavior: 'smooth' });
  }

  function startAutoplay(){
    if (reduceMotion || autoTimer) return;
    autoTimer = setInterval(tick, 2500);
  }
  function pauseAutoplay(){
    if (autoTimer) { clearInterval(autoTimer); autoTimer = null; }
    if (resumeTimer) { clearTimeout(resumeTimer); resumeTimer = null; }
  }
  function resumeAutoplaySoon(){
    if (reduceMotion) return;
    if (resumeTimer) clearTimeout(resumeTimer);
    resumeTimer = setTimeout(startAutoplay, 1800);
  }

  slider.addEventListener('wheel', () => { pauseAutoplay(); resumeAutoplaySoon(); }, {passive: true});
  window.addEventListener('resize', () => { pauseAutoplay(); resumeAutoplaySoon(); });

  // защитимся от перетаскивания изображений
  slider.querySelectorAll('img').forEach(img => img.setAttribute('draggable','false'));

  // старт
  startAutoplay();
})();
</script>